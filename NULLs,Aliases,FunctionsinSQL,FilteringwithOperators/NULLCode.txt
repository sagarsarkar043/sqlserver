-- NULL Demo

--Create Tables
--Employees
CREATE TABLE Employees (
    EmployeeID INT PRIMARY KEY,
    EmployeeName VARCHAR(100) NOT NULL,
    Department VARCHAR(50) NOT NULL,
    Email VARCHAR(100) NULL,
    PhoneNumber VARCHAR(15) NULL,
    ManagerID INT NULL,
    JoiningDate DATE NOT NULL,
    Salary DECIMAL(10,2) NULL
);


--Data Summary
--Email, PhoneNumber, ManagerID, Salary allow NULL
--EmployeeName, Department, JoiningDate are NOT NULL

CREATE TABLE S (
    SaleID INT PRIMARY KEY,
    EmployeeID INT NOT NULL,
    SaleDate DATE NOT NULL,
    SaleAmount DECIMAL(10,2) NULL,
    CustomerFeedback VARCHAR(200) NULL,
    FOREIGN KEY (EmployeeID) REFERENCES Employees(EmployeeID)
);

--Insert Sample Data (With NULLs)
--Employees
INSERT INTO Employees VALUES
(1, 'Amit Sharma', 'Sales', 'amit@company.com', '9876543210', NULL, '2023-01-10', 50000),
(2, 'Neha Verma', 'HR', NULL, '9876543222', 1, '2023-02-15', 40000),
(3, 'Rohit Singh', 'IT', 'rohit@company.com', NULL, 1, '2023-03-20', NULL),
(4, 'Anjali Mehta', 'Sales', NULL, NULL, 1, '2023-04-05', 55000),
(5, 'Suresh Iyer', 'Finance', 'suresh@company.com', '9876543333', NULL, '2023-05-12', 60000);

--Sales
INSERT INTO S VALUES
(101, 1, '2024-01-05', 25000, 'Good service'),
(102, 2, '2024-01-10', NULL, NULL),
(103, 3, '2024-01-15', 18000, 'Average'),
(104, 4, '2024-02-01', NULL, 'Delayed'),
(105, 1, '2024-02-10', 30000, NULL);

--Problem 1--Find employees who do not have an email ID

SELECT *
FROM Employees
WHERE Email IS NULL;

--Problem 2--Find employees who have provided a phone number

SELECT *
FROM Employees
WHERE PhoneNumber IS NOT NULL;

--Problem 3--List employees whose salary is not yet assigned

SELECT EmployeeName, Department
FROM Employees
WHERE Salary IS NULL;

--Problem 4--Find sales records where sale amount is missing

SELECT *
FROM S
WHERE SaleAmount IS NULL;

--Problem 5--Show sales where customer feedback is available

SELECT *
FROM S
WHERE CustomerFeedback IS NOT NULL;

--Problem 6--Count how many employees do not have managers

SELECT COUNT(*) AS EmployeesWithoutManager
FROM Employees
WHERE ManagerID IS NULL;

--Problem 7--Calculate total sales ignoring NULL sale amounts

SELECT SUM(SaleAmount) AS TotalSales
FROM S;


--SUM() automatically ignores NULL values.

--Problem 8--Display employee names with salary, show 0 if salary is NULL

SELECT 
    EmployeeName,
    ISNULL(Salary, 0) AS Salary
FROM Employees;

--Problem 9--Find employees who have both email and phone number missing

SELECT *
FROM Employees
WHERE Email IS NULL
AND PhoneNumber IS NULL;

--Problem 10

Select * from S;

Select Count(*) from S;
-- Does not considers Null Value 

Select COUNT(SaleAmount) from S;
-- Considers Null Value wrt the column considered in the Aggregate function
